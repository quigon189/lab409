#### **1. Тема**
Изучение технологии VLAN (Virtual Local Area Network), ее настройка на коммутаторах Cisco и организация маршрутизации между VLANами.

#### **2. Цель работы**
- **Теоретическая:** Изучить принципы работы виртуальных локальных сетей (VLAN), их назначение и преимущества.
- **Практическая:** Приобрести навыки настройки VLAN на коммутаторах Cisco, конфигурации портов в режимах Access и Trunk, настройки маршрутизации между VLANами с использованием роутера (Router-on-a-Stick).

#### **3. Задачи**
1.  Создать и настроить VLAN на коммутаторах.
2.  Назначить порты коммутаторов соответствующим VLAN в режиме Access.
3.  Настроить соединение между коммутаторами в режиме Trunk с ограничением передаваемых VLAN.
4.  Настроить маршрутизацию между VLANами на роутере с помощью сабинтерфейсов.
5.  Выполнить дополнительные задания:
    *   Перевести неиспользуемые порты в черный VLAN (Blackhole) – VLAN 99.
    *   Изменить номер Native VLAN на 77.

#### **4. Оборудование и программное обеспечение**
- **Программное обеспечение:** Cisco Packet Tracer.

#### **5. Краткие теоретические сведения**

**Виртуальная локальная сеть (VLAN)** — это логическая группа устройств, объединенных по какому-либо признаку (например, по отделам компании), хотя физически они могут быть подключены к разным коммутаторам. Трафик между разными VLANами передается только через маршрутизатор (или L3-коммутатор), что повышает безопасность и производительность сети.

**Основные свойства и преимущества VLAN:**
*   **Логическая изоляция:** Устройства в разных VLANах не "видят" друг друга на канальном уровне (L2), даже если подключены к одному коммутатору.
*   **Повышение безопасности:** Ограничение широковещательного трафика и возможность тонкой настройки политик доступа между сегментами сети.
*   **Упрощение управления:** Логическая структура сети не зависит от физического расположения устройств.

**Типы портов коммутатора:**
*   **Access Port:** Принимает и передает нетэгированные кадры. Назначается только одному VLANу. Используется для подключения конечных устройств (компьютеры, принтеры, IP-камеры).
*   **Trunk Port:** Передает кадры для нескольких VLANов, помечая их тегами (IEEE 802.1Q). Используется для соединения коммутаторов между собой или коммутатора с маршрутизатором.

**Native VLAN:** Специальный VLAN, кадры которого передаются через Trunk-порт без тега 802.1Q. **Важно!** Native VLAN должен совпадать на обоих концах Trunk-соединения. По умолчанию используется VLAN 1. Изменение Native VLAN повышает безопасность.

**Маршрутизация между VLANами (Router-on-a-Stick):** Для организации обмена данными между разными VLANами используется маршрутизатор. На его физическом интерфейсе создаются подынтерфейсы (subinterfaces), каждый из которых ассоциируется с определенным VLANом с помощью инкапсуляции 802.1Q и имеет свой IP-адрес, выступая шлюзом для устройств в этом VLAN.

#### **6. Порядок выполнения работы**

**6.1. Подготовка сети**
1.  Соберите топологию сети в Cisco Packet Tracer в соответствии с предоставленным вариантом.
2.  Настройте IP-адресацию на персональных компьютерах (PC) согласно таблице варианта.
3. *Ниже представлены примеры команд. Ваши названия устройств и номера VLAN зависят от варианта!*

**6.2. Базовая настройка коммутаторов и создание VLAN**
1. Переименуйте коммутаторы для удобства идентификации.
```
    Switch(config)# hostname SW1
```
2.  На коммутаторе SW1 создайте необходимые VLAN и назначьте им имена.
```
    SW1(config)# vlan 2
    SW1(config-vlan)# name Dir-ya
```

**6.3. Настройка портов в режиме Access**
1.  Сгруппируйте порты, подключенные к конечным устройствам, и переведите их в режим Access.
2.  Назначьте порты соответствующим VLAN.
```
    SW1(config)# interface range fastEthernet 0/1-2
    SW1(config-if-range)# switchport mode access
    SW1(config-if-range)# switchport access vlan 2
```
Повторите шаг для остальных портов и VLAN в соответствии с таблицей.

**6.4. Настройка магистральных соединений (Trunk)**
1.  Настройте порт, соединяющий SW1 и CentrSW, в режим Trunk.
```
    SW1(config)# interface fastEthernet 0/24
    SW1(config-if)# switchport mode trunk
```
2.  Ограничьте список VLAN, разрешенных для передачи через trunk-порт.
```
    SW1(config-if)# switchport trunk allowed vlan 2,3,4
```
3.  Аналогичные настройки выполните на коммутаторе CentrSW для порта, подключенного к SW1.

**6.5. Настройка маршрутизации между VLAN (Router-on-a-Stick)**
1.  Переименуйте маршрутизатор.
```
    Router(config)# hostname Gateway
```
2.  Активируйте физический интерфейс, подключенный к центральному коммутатору.
```
    Gateway(config)# interface fastEthernet 0/0
    Gateway(config-if)# no shutdown
```
3.  Создайте подынтерфейсы для каждого VLAN и назначьте им IP-адреса (адреса шлюзов по умолчанию для соответствующих VLAN) для вашего варианта.
```
    Gateway(config)# interface fastEthernet 0/0.2
    Gateway(config-subif)# encapsulation dot1Q 2
    Gateway(config-subif)# ip address 192.168.1.1 255.255.255.0

    Gateway(config)# interface fastEthernet 0/0.3
    Gateway(config-subif)# encapsulation dot1Q 3
    Gateway(config-subif)# ip address 192.168.2.1 255.255.255.0

    Gateway(config)# interface fastEthernet 0/0.4
    Gateway(config-subif)# encapsulation dot1Q 4
    Gateway(config-subif)# ip address 192.168.3.1 255.255.255.0
```

**6.6. Выполнение дополнительных заданий**
1.  **Настройка неиспользуемых портов:**
*   Создайте VLAN 99 с именем `Unused` (или `Blackhole`).
```
    SW1(config)# vlan 99
    SW1(config-vlan)# name Unused
```

*   Переведите все неиспользуемые порты в режим access, назначьте их VLAN 99 и деактивируйте командой `shutdown`.
```
    SW1(config)# interface range fastEthernet 0/3-23, gig0/1-2
    SW1(config-if-range)# switchport mode access
    SW1(config-if-range)# switchport access vlan 99
    SW1(config-if-range)# shutdown
```
2.  **Изменение Native VLAN:**
*   На всех trunk-портах всех коммутаторов измените номер Native VLAN на 77.
```
    SW1(config)# interface fastEthernet 0/24
    SW1(config-if)# switchport trunk native vlan 77
```
*   Убедитесь, что настройка совпадает на обоих концах каждого trunk-соединения.

**6.7. Проверка работоспособности конфигурации**
1.  Используйте команду `show vlan brief` для проверки создания VLAN и назначения на них портов.
2.  Используйте команду `show interfaces trunk` для проверки статуса trunk-портов и списка разрешенных VLAN.
3.  Проверьте связь (ping):
    *   Между компьютерами внутри одного VLAN (должна быть успешной).
    *   Между компьютерами из разных VLAN (должна быть успешной через маршрутизатор).
    *   С шлюзом по умолчанию для каждого VLAN.

**6.8. Сохранение конфигураций**
Сохраните текущую конфигурацию на всех сетевых устройствах.
```
Switch# copy running-config startup-config
Router# copy running-config startup-config
```

#### **7. Контрольные вопросы**
1.  Дайте определение VLAN. Какие проблемы решает использование VLAN в сети?
2.  В чем разница между режимами портов Access и Trunk?
3.  Что такое тег IEEE 802.1Q и для чего он нужен?
4.  Что такое Native VLAN? Почему рекомендуется изменять номер Native VLAN по умолчанию (VLAN 1)?
5.  Какая команда позволяет просмотреть список VLAN на коммутаторе? Какая команда отображает статус Trunk-портов?
6.  Для чего используется команда `switchport trunk allowed vlan`?
7.  Объясните назначение команды `encapsulation dot1Q X` в конфигурации сабинтерфейса маршрутизатора.
8.  Где на коммутаторе хранится информация о VLAN? Как полностью удалить все настройки VLAN с коммутатора?
9. Каковы были бы последствия, если бы Native VLAN на концах Trunk-линии не совпадал?

#### **8. Содержание отчета**
- Титульный лист.
- Тема, цель, задачи работы.
- Схема сети с указанием VLAN, IP-адресов и типов портов.
- Конфигурации всех активных сетевых устройств (команды, которые вы вводили).
- Результаты проверки связности (ping) внутри VLAN и между VLANами.
- Ответы на контрольные вопросы.
- Выводы по работе.