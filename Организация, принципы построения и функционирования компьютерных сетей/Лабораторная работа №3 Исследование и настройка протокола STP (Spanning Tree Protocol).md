#### **1. Тема**
Протокол STP (Spanning Tree Protocol). Обеспечение отказоустойчивости и предотвращение петель в сетях с избыточными соединениями.

#### **2. Цель работы**
- **Теоретическая:** Изучить принципы работы протокола STP, его роль в предотвращении сетевых петель и обеспечении отказоустойчивости.
- **Практическая:** Приобрести навыки настройки STP, приоритетов портов и исследования процессов переключения на резервные каналы.

#### **3. Задачи**
1. Расширить сеть из предыдущей работы, добавив серверное оборудование.
2. Настроить отдельный VLAN для серверов.
3. Настроить STP для обеспечения резервирования каналов связи.
4. Исследовать процесс переключения при обрыве основного канала.
5. Настроить Rapid PVST+ и сравнить время восстановления связи.

#### **4. Оборудование и программное обеспечение**
- **Программное обеспечение:** Cisco Packet Tracer.
- **Оборудование (в эмуляторе):**
  - Коммутаторы Cisco - 4-5 шт.
  - Серверы (файл-сервер и веб-сервер) - 2 шт.
  - Персональные компьютеры - 2-4 шт.
  - Соединительные провода.

#### **5. Краткие теоретические сведения**

**STP (Spanning Tree Protocol)** - протокол, предотвращающий образование петель в сетях с избыточными соединениями. Основные понятия:

- **Корневой мост (Root Bridge)** - коммутатор с наименьшим Bridge ID
- **Корневой порт (Root Port)** - порт с наименьшей стоимостью пути к корневому мосту
- **Назначенный порт (Designated Port)** - порт, передающий трафик в сегменте сети
- **Заблокированный порт (Blocked Port)** - порт, отключенный для предотвращения петель

**Типы протоколов STP:**
- **PVST+ (Per VLAN Spanning Tree)** - отдельное STP дерево для каждого VLAN
- **Rapid PVST+** - ускоренная версия с быстрым восстановлением
- **MSTP (Multiple Spanning Tree)** - объединение VLAN в группы

#### **6. Порядок выполнения работы**

**6.1. Построение сетевой топологии**
1. Добавьте к существующей сети из лабораторной работы 1 два новых коммутатора (SW-server1, SW-server2) и два сервера (файл-сервер и веб-сервер).
2. Создайте отдельный VLAN для серверов (например, VLAN 40).
3. Подключите оборудование согласно схеме указанной преподавателем, создав избыточные соединения.

**6.2. Базовая настройка VLAN для серверов**
1. На всех коммутаторах создайте VLAN для серверов:
   ```text
   SW-server1(config)# vlan 40
   SW-server1(config-vlan)# name Servers
   ```

2. Назначьте порты, подключенные к серверам, в VLAN 40:
   ```text
   SW-server1(config)# interface fa0/1
   SW-server1(config-if)# switchport mode access
   SW-server1(config-if)# switchport access vlan 40
   ```

**6.3. Исследование работы STP по умолчанию**
1. Проверьте текущее состояние STP для VLAN 40:
   ```text
   SW-server1# show spanning-tree vlan 40
   ```

2. Определите, какой коммутатор является корневым мостом.
3. Определите, какие порты находятся в состоянии Forwarding, а какие - Blocking.

**6.4. Настройка приоритетов STP**
1. Настройте SW-server1 как корневой мост для VLAN 10:
   ```text
   SW-server1(config)# spanning-tree vlan 40 root primary
   ```

2. Настройте SW-server2 как резервный корневой мост:
   ```text
   SW-server2(config)# spanning-tree vlan 40 root secondary
   ```

3. Убедитесь, что резервным каналом является линк между SW-server1 и SW-server2.

**6.5. Тестирование отказоустойчивости**
1. С любого ПК запустите непрерывный ping до веб-сервера:
   ```bash
   ping -t ip_address_web_server
   ```

2. Отключите основной линк (между CentrSW и SW-server1).
3. Наблюдайте за поведением ping и зафиксируйте:
   - Количество потерянных пакетов
   - Время восстановления связи
   - Сообщения на коммутаторах

4. Проверьте изменение состояния портов STP:
   ```text
   show spanning-tree vlan 40
   ```

**6.6. Настройка Rapid PVST+**
1. На всех коммутаторах переключитесь на Rapid PVST+:
   ```text
   SW-server1(config)# spanning-tree mode rapid-pvst
   ```

2. Повторите тестирование из пункта 6.5.
3. Сравните время восстановления связи с обычным STP.

**6.7. Анализ результатов**
1. Сравните время восстановления при использовании STP и Rapid PVST+.
2. Объясните разницу в механизмах работы протоколов.
3. Проанализируйте преимущества Rapid PVST+.

#### **7. Контрольные вопросы**
1. Каково назначение протокола STP в компьютерных сетях?
2. Что такое корневой мост и как он выбирается?
3. Какие состояния портов существуют в STP и что они означают?
4. Как происходит процесс перевыбора корневого моста?
5. В чем отличие PVST+ от Rapid PVST+?
6. Как настроить коммутатор в качестве основного корневого моста?
7. Какие команды используются для мониторинга состояния STP?
8. Как предотвратить образование петель в сети с избыточными соединениями?
9. Что такое BPDU и какую роль они играют в работе STP?
10. Какие факторы влияют на выбор корневого порта?

#### **8. Содержание отчета**
- Тема, цель и задачи работы.
- Схема сети с обозначением VLAN и STP-ролей портов.
- Результаты выполнения заданий:
  - Выводы команд `show spanning-tree vlan 40` до и после настройки
  - Скриншоты изменений состояния портов при обрыве канала
  - Таблица сравнения времени восстановления STP и Rapid PVST+
  - Результаты ping-тестирования
- Ответы на контрольные вопросы.
- Выводы по работе с обоснованием преимуществ Rapid PVST+.