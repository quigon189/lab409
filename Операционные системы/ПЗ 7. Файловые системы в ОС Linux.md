**Тема:** Изучение файловых систем, их характеристик и инструментов управления в Linux.  
**Цель:**  
Освоить принципы работы файловых систем ext4, XFS, Btrfs и F2FS, научиться создавать разделы, форматировать диски, настраивать LVM и анализировать свойства файловых систем.

---

#### **Задание 1: Создание разделов и форматирование**  

1. **Создание раздела с помощью `fdisk`:**  
   - Создайте виртуальный диск:  
     ```bash  
     sudo fallocate -l 10G ~/test_disk.img  
     sudo losetup /dev/loop409 ~/test_disk.img  
     ```  
   - Определите имя диска (например, `/dev/loop409`):  
     ```bash  
     sudo fdisk -l  
     ```  
   - Запустите `fdisk`:  
     ```bash  
     sudo fdisk /dev/loop409  
     ```  
     - Создайте 3 новых раздел, сохраните изменения.  

2. **Форматирование в разные ФС:**  
   - Установить `btrfs-progs` и `xfsprogs`
     ```bash
     sudo apt install btrfs-progs xfsprogs -y
     ```
   - Для ext4:  
     ```bash  
     sudo mkfs.ext4 /dev/loop409p1  
     ```  
   - Для XFS:  
     ```bash  
     sudo mkfs.xfs /dev/loop409p2  
     ```  
   - Для Btrfs:  
     ```bash  
     sudo mkfs.btrfs /dev/loop409p3  
     ```  

**Вопросы для отчёта:**  
- Какие параметры можно задать при форматировании в ext4 (например, размер inode)?  
- Чем отличается команда `mkfs.xfs` от `mkfs.ext4`?  

---

#### **Задание 2: Монтирование и настройка файловых систем**  

1. **Ручное монтирование:**  
   - Создайте точку монтирования:  
     ```bash  
     sudo mkdir /mnt/test_fs  
     ```  
   - Смонтируйте разделы:  
     ```bash  
     sudo mount /dev/loop409p1 /mnt/test_fs  
     ```  
   - Проверьте:  
     ```bash  
     df -Th /mnt/test_fs  
     ```  
1. **Автоматическое монтирование через `/etc/fstab`:**  
   - Определите UUID разделов:  
     ```bash  
     sudo blkid /dev/loop409p1  
     ```  
   - Добавьте строку в `/etc/fstab`:  
     ```  
     UUID=<ваш_UUID> /mnt/test_fs ext4 defaults 0 0  
     ```  
   - Примените изменения:  
     ```bash  
     sudo mount -a  
     ```  
   - Удалите строку из файла `/etc/fstab`

**Вопросы для отчёта:**  
- Чем отличается `UUID` от имени устройства (`/dev/sda1`)?  
- Что означают параметры `defaults`, `0 0` в `/etc/fstab`?  

---

#### **Задание 3: Работа с LVM (Logical Volume Manager)**  

1. **Установите пакет `lvm2`:**
   ```bash
   sudo apt install lvm2 -y
   ```
2. **Создайте 3 физических тома (PV):**  
   ```bash  
   sudo pvcreate /dev/loop409p1  
   ```  

3. **Создайте группу томов (VG) и добавьте в нее физические тома:**  
   ```bash  
   sudo vgcreate test_vg /dev/loop409p1  
   ```  

4. **Создайте логического тома (LV):**  
   ```bash  
   sudo lvcreate -L 1G -n test_lv test_vg  
   ```  

5. **Выполните форматирование и монтирование логического тома:**  
   ```bash  
   sudo mkfs.ext4 /dev/test_vg/test_lv  
   sudo mount /dev/test_vg/test_lv /mnt/lvm_test  
   ```  
6. **Удалите логический том, группу и физические тома**
**Вопросы для отчёта:**  
- Какие преимущества дает использование LVM?  
- Как расширить логический том, если добавится новый диск?  

---

#### **Задание 4: Анализ и восстановление файловой системы**  

1. **Выполните проверку целостности ext4:**  
   ```bash  
   sudo fsck.ext4 -f /dev/loop409p1  
   ```  

2. **Восстановление данных с помощью `testdisk`:**  
   - Установите утилиту:  
     ```bash  
     sudo apt install testdisk  
     ```  
   - Запустите сканирование:  
     ```bash  
     sudo testdisk /dev/loop409  
     ```  

**Вопросы для отчёта:**  
- Какие типы повреждений ФС может исправить `fsck`?  
- Как `testdisk` помогает восстановить удаленные разделы?  

---

#### **Задание 5: Настройка прав доступа**  

1. **Использование `chmod` и `chown`:**  
   - Изучите утилиты `chmod` и `chown`:
	```bash
	man chmod
	man chown
	```
   - Создайте файл на монтированном ранее томе:  
     ```bash  
     sudo touch /mnt/test_fs/test_file.txt  
     ```  
   - Измените владельца:  
     ```bash  
     sudo chown user:user /mnt/test_fs/test_file.txt  
     ```  
   - Установите права:  
     ```bash  
     sudo chmod 750 /mnt/test_fs/test_file.txt  
     ```  

---

### **Заключительные вопросы для защиты:**  
1. В чем преимущество Btrfs перед ext4?  
2. Как увеличить размер логического тома в LVM?  
3. Почему XFS рекомендуется для серверов баз данных?  
4. Какие инструменты Linux позволяют мониторить использование диска?  